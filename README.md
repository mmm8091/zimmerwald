# Zimmerwald v1.1 "International"

å›½é™…å…±äº§ä¸»ä¹‰è¿åŠ¨æƒ…æŠ¥ä»ªè¡¨ç›˜ï¼ˆIntelligence Dashboardï¼‰

## ğŸ“– ç®€ä»‹

Zimmerwald æ˜¯ä¸€ä¸ªè‡ªåŠ¨åŒ–çš„æ–°é—»èšåˆä¸åˆ†æå¹³å°ï¼Œä¸“æ³¨äºå›½é™…å…±äº§ä¸»ä¹‰è¿åŠ¨ç›¸å…³çš„æ–°é—»æŠ¥é“ã€‚v1.1 "International" ç‰ˆæœ¬å°† MVP å‡çº§ä¸º**æƒ…æŠ¥ä»ªè¡¨ç›˜**ï¼Œæä¾›ï¼š

- ğŸ¤– **å”¯ç‰©ä¸»ä¹‰è¯„åˆ†ç³»ç»Ÿ**ï¼šåŸºäºâ€œç‰©è´¨åŠ›é‡â€é‡‘å­—å¡”çš„ 0â€“100 åˆ†è¯„åˆ†
- ğŸŒ **åŒè¯­æƒ…æŠ¥**ï¼šä¸­è‹±æ–‡æ ‡é¢˜ä¸æ‘˜è¦ï¼Œé¢å‘å›½é™…è¯»è€…
- ğŸ·ï¸ **ä¸Šä¸‹æ–‡æ„ŸçŸ¥æ ‡ç­¾**ï¼šLLM ä¼˜å…ˆå¤ç”¨çƒ­é—¨æ ‡ç­¾ï¼Œå½¢æˆè‡ªå¢å¼ºè®°å¿†
- ğŸ‘¥ **ç¾¤ä¼—å®¡è®¡æœºåˆ¶**ï¼šç”¨æˆ·å¯å¯¹ AI è¯„åˆ†è¿›è¡ŒæŠ•ç¥¨åé¦ˆ
- ğŸ“Š **å¯è§†åŒ–ç­›é€‰**ï¼šç›´æ–¹å›¾ã€æ ‡ç­¾äº‘ã€åˆ†ç±»ç­›é€‰ï¼Œå¿«é€Ÿå®šä½é«˜ä»·å€¼æƒ…æŠ¥

> **å‘½åæ¥æº**ï¼šä»¥ 1915 å¹´é½é»˜å°”ç“¦å°”å¾·ä¼šè®®å‘½åï¼Œçºªå¿µå›½é™…å…±äº§ä¸»ä¹‰è¿åŠ¨çš„å›¢ç»“ä¼ ç»Ÿã€‚

## âœ¨ æ ¸å¿ƒåŠŸèƒ½

### v1.1 "International" æ–°ç‰¹æ€§

- ğŸ¯ **æƒ…æŠ¥ä»ªè¡¨ç›˜**ï¼šç›´æ–¹å›¾æ»‘å—ã€æ ‡ç­¾äº‘ã€åˆ†ç±»ç­›é€‰ï¼Œå¿«é€Ÿå®šä½é«˜ä»·å€¼æ–°é—»
- ğŸŒ **åŒè¯­æ”¯æŒ**ï¼šä¸­è‹±æ–‡æ ‡é¢˜ä¸æ‘˜è¦ï¼Œä¸€é”®åˆ‡æ¢è¯­è¨€ï¼ˆCN/ENï¼‰
- ğŸ·ï¸ **ä¸Šä¸‹æ–‡æ„ŸçŸ¥æ ‡ç­¾**ï¼šLLM è‡ªåŠ¨å¤ç”¨æœ€è¿‘ 7 å¤©çš„ Top 30 çƒ­é—¨æ ‡ç­¾ï¼Œå½¢æˆæ ‡ç­¾è®°å¿†
- ğŸ‘¥ **ç¾¤ä¼—å®¡è®¡**ï¼šç”¨æˆ·å¯å¯¹ AI è¯„åˆ†æŠ•ç¥¨ï¼ˆåé«˜/åˆç†/åä½ï¼‰ï¼Œä¸ºæ¨¡å‹ä¼˜åŒ–æä¾›æ•°æ®
- ğŸ“Š **å”¯ç‰©ä¸»ä¹‰è¯„åˆ†**ï¼šåŸºäºâ€œç‰©è´¨åŠ›é‡â€é‡‘å­—å¡”çš„ä¸¥æ ¼è¯„åˆ†ç³»ç»Ÿï¼ˆ0â€“100ï¼‰

### åŸºç¡€åŠŸèƒ½

- ğŸ“° **å¤šæºèšåˆ**ï¼šè‡ªåŠ¨æŠ“å– 20+ ä¸ªå›½é™…å·¦ç¿¼æ–°é—»æºçš„ RSS è®¢é˜…
- ğŸ¤– **æ™ºèƒ½åˆ†æ**ï¼šä½¿ç”¨ DeepSeek / OpenRouter ç­‰ LLM æ¨¡å‹è¿›è¡Œæ–°é—»åˆ†æ
- ğŸ“Š **è‡ªåŠ¨åˆ†ç±»**ï¼šLabor / Politics / Conflict / Theory å››ç±»åˆ†ç±»
- ğŸ—„ï¸ **æ•°æ®å­˜å‚¨**ï¼šCloudflare D1ï¼ˆSQLiteï¼‰æŒä¹…åŒ–å­˜å‚¨
- ğŸŒ **å…¨çƒè®¿é—®**ï¼šåŸºäº Cloudflare Workers çš„è¾¹ç¼˜è®¡ç®—
- â° **å®šæ—¶æ›´æ–°**ï¼šæ¯å°æ—¶è‡ªåŠ¨æŠ“å–å’Œåˆ†ææœ€æ–°æ–°é—»

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å‰ç½®è¦æ±‚

- Node.js 18+ 
- npm æˆ– yarn
- Cloudflare è´¦æˆ·
- LLM API å¯†é’¥ï¼ˆDeepSeekã€OpenRouter ç­‰ï¼‰

### å®‰è£…æ­¥éª¤

1. **å…‹éš†ä»“åº“**

```bash
git clone https://github.com/yourusername/zimmerwald.git
cd zimmerwald
```

2. **å®‰è£…ä¾èµ–**

```bash
npm install
```

3. **åˆ›å»º D1 æ•°æ®åº“**

```bash
npm run db:create
```

å°†è¾“å‡ºçš„æ•°æ®åº“ ID å¤åˆ¶åˆ° `wrangler.toml` ä¸­çš„ `database_id` å­—æ®µã€‚

4. **åˆå§‹åŒ–æ•°æ®åº“**

```bash
# æœ¬åœ°å¼€å‘
npm run db:local

# ç”Ÿäº§ç¯å¢ƒ
npm run db:migrate
```

5. **é…ç½®ç¯å¢ƒå˜é‡**

ä½¿ç”¨ Cloudflare Secrets è®¾ç½®ï¼š

```bash
wrangler secret put AI_API_KEY
wrangler secret put AI_API_BASE
wrangler secret put AI_MODEL_NAME
wrangler secret put AI_API_TYPE  # å¯é€‰ï¼Œé»˜è®¤ä¸º 'openai'
```

æˆ–åˆ›å»º `.dev.vars` æ–‡ä»¶ï¼ˆç”¨äºæœ¬åœ°å¼€å‘ï¼‰ï¼š

```env
AI_API_KEY=your-api-key
AI_API_BASE=https://api.deepseek.com
AI_MODEL_NAME=deepseek-reasoner
AI_API_TYPE=openai
```

6. **æœ¬åœ°å¼€å‘**

```bash
npm run dev
```

è®¿é—® `http://localhost:8787` æŸ¥çœ‹ç»“æœã€‚

7. **éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ**

```bash
npm run deploy
```

## ğŸ“š é…ç½®è¯´æ˜

### RSS æºé…ç½®

ç¼–è¾‘ `src/config/rss-sources.ts` æ¥æ·»åŠ ã€åˆ é™¤æˆ–å¯ç”¨/ç¦ç”¨ RSS æºã€‚

### è°ƒåº¦å™¨é…ç½®

ç¼–è¾‘ `src/config/scheduler.ts` æ¥è°ƒæ•´ï¼š
- æ¯æ¬¡è¿è¡Œå¤„ç†çš„æºæ•°é‡
- æ¯ä¸ªæºå¤„ç†çš„æ–‡ç« æ•°é‡
- å»¶è¿Ÿæ—¶é—´ï¼ˆé¿å… API é™æµï¼‰

### LLM é…ç½®

ç¼–è¾‘ `src/config/llm.ts` æ¥è°ƒæ•´ï¼š
- Token é™åˆ¶
- æ¸©åº¦å‚æ•°
- ç³»ç»Ÿæç¤ºè¯

## ğŸŒ API ç«¯ç‚¹

### ç”Ÿäº§ç«¯ç‚¹

- `GET /` - å‰ç«¯ Intelligence Dashboardï¼ˆçº¯å‰ç«¯æ¸²æŸ“ï¼‰
- `GET /api/news` - è·å–æ–°é—»åˆ—è¡¨ï¼ˆJSONï¼‰
  - Query å‚æ•°ï¼š
    - `min_score`ï¼ˆå¯é€‰ï¼Œé»˜è®¤ 75ï¼‰ï¼šæœ€ä½è¯„åˆ†è¿‡æ»¤
    - `category`ï¼ˆå¯é€‰ï¼‰ï¼š`Labor` / `Politics` / `Conflict` / `Theory`
    - `tag`ï¼ˆå¯é€‰ï¼‰ï¼šæ ‡ç­¾æ¨¡ç³ŠåŒ¹é…ï¼ˆä¸­è‹±æ–‡ï¼‰
    - `limit`ï¼ˆå¯é€‰ï¼Œé»˜è®¤ 30ï¼‰ï¼šè¿”å›æ¡æ•°
- `POST /api/feedback` - ç¾¤ä¼—å®¡è®¡æŠ•ç¥¨
  - Body: `{ "article_id": 123, "vote_type": "too_high"|"accurate"|"too_low" }`

### æµ‹è¯•ç«¯ç‚¹

- `GET /test/fetch?limit=50` - æ‰‹åŠ¨è§¦å‘æ–°é—»æŠ“å–ï¼ˆé™åˆ¶å¤„ç†æ•°é‡ï¼‰
- `GET /test/llm` - æµ‹è¯• LLM API è°ƒç”¨ï¼ˆè¿”å›è¯¦ç»†å“åº”ï¼‰
- `GET /test/rss?url=...` - æµ‹è¯•å•ä¸ª RSS æº
- `GET /test/all-rss` - æ‰¹é‡æµ‹è¯•æ‰€æœ‰ RSS æº
- `GET /test/tags` - æŸ¥çœ‹å½“å‰çƒ­é—¨æ ‡ç­¾æ± ï¼ˆéªŒè¯ Context Loopï¼‰

## ğŸ—„ï¸ æ•°æ®åº“ Schema (v1.1)

### `articles` è¡¨ï¼ˆæƒ…æŠ¥æ ¸å¿ƒï¼‰

```sql
CREATE TABLE articles (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  url TEXT UNIQUE NOT NULL,
  source_id TEXT NOT NULL,
  published_at INTEGER,
  created_at INTEGER NOT NULL,
  -- åŒè¯­å†…å®¹
  title_en TEXT,
  title_zh TEXT,
  summary_en TEXT,
  summary_zh TEXT,
  -- å…ƒæ•°æ®
  category TEXT,              -- Labor|Politics|Conflict|Theory
  tags TEXT,                  -- JSON: [{"en":"Strike","zh":"ç½¢å·¥"}]
  score INTEGER,              -- 0-100
  ai_reasoning TEXT          -- AI è¯„åˆ†ç†ç”±ï¼ˆå†…éƒ¨è°ƒè¯•ç”¨ï¼‰
);
```

### `feedback` è¡¨ï¼ˆç¾¤ä¼—å®¡è®¡ï¼‰

```sql
CREATE TABLE feedback (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  article_id INTEGER NOT NULL,
  vote_type TEXT NOT NULL,   -- too_high|accurate|too_low
  user_hash TEXT NOT NULL,    -- IP+UA å“ˆå¸ŒæŒ‡çº¹
  created_at INTEGER NOT NULL
);
```

å®Œæ•´ Schema è§ [`schema_v1_1.sql`](./schema_v1_1.sql)

## ğŸ”§ æŠ€æœ¯æ ˆ

- **Runtime**: Cloudflare Workers (TypeScript)
- **Database**: Cloudflare D1 (SQLite)
- **AI Service**: DeepSeek / OpenRouter / Anthropicï¼ˆOpenAI å…¼å®¹æ ¼å¼ï¼‰
- **Frontend**: HTML + TailwindCSS + åŸç”Ÿ JSï¼ˆæ— æ¡†æ¶ä¾èµ–ï¼‰
- **RSS Parser**: fast-xml-parser
- **æ¶æ„æ¨¡å¼**: æ¨¡å—åŒ–åˆ†å±‚ï¼ˆcore / api / configï¼‰

## ğŸ“ é¡¹ç›®ç»“æ„ (v1.1)

```
zimmerwald/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ config/          # é…ç½®æ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ rss-sources.ts  # RSS æºåˆ—è¡¨
â”‚   â”‚   â”œâ”€â”€ scheduler.ts     # è°ƒåº¦å™¨é…ç½®
â”‚   â”‚   â”œâ”€â”€ llm.ts          # LLM é…ç½®ï¼ˆPromptã€æ¸©åº¦ã€Tokenï¼‰
â”‚   â”‚   â””â”€â”€ app.ts          # åº”ç”¨é…ç½®
â”‚   â”œâ”€â”€ core/            # æ ¸å¿ƒä¸šåŠ¡é€»è¾‘
â”‚   â”‚   â”œâ”€â”€ types.ts         # ç±»å‹å®šä¹‰
â”‚   â”‚   â”œâ”€â”€ db.ts            # D1 æ•°æ®åº“æ“ä½œ
â”‚   â”‚   â”œâ”€â”€ rss.ts           # RSS æŠ“å–ä¸è§£æ
â”‚   â”‚   â”œâ”€â”€ llm.ts           # LLM API è°ƒç”¨ï¼ˆå« Context Loopï¼‰
â”‚   â”‚   â”œâ”€â”€ news.ts          # æ–°é—»æŸ¥è¯¢ä¸æ˜ å°„
â”‚   â”‚   â”œâ”€â”€ sources.ts      # source_id â†” source_name è½¬æ¢
â”‚   â”‚   â””â”€â”€ utils.ts         # å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ api/              # API Handler
â”‚   â”‚   â”œâ”€â”€ news.ts          # GET /api/news å¤„ç†
â”‚   â”‚   â”œâ”€â”€ feedback.ts      # POST /api/feedback å¤„ç†
â”‚   â”‚   â””â”€â”€ test.ts          # æµ‹è¯•ç«¯ç‚¹å¤„ç†
â”‚   â”œâ”€â”€ frontend/         # å‰ç«¯ç›¸å…³
â”‚   â”‚   â””â”€â”€ html.ts          # HTML é¡µé¢ç”Ÿæˆ
â”‚   â””â”€â”€ scheduler.ts      # å®šæ—¶ä»»åŠ¡è°ƒåº¦å™¨
â”œâ”€â”€ docs/
â”‚   â””â”€â”€ zimmerwald_v1_1_design.md  # v1.1 æ¶æ„è®¾è®¡æ–‡æ¡£
â”œâ”€â”€ worker.ts            # Worker ä¸»å…¥å£ï¼ˆè·¯ç”±åˆ†å‘ï¼Œä»… 67 è¡Œï¼‰
â”œâ”€â”€ schema_v1_1.sql      # v1.1 æ•°æ®åº“ Schema
â”œâ”€â”€ wrangler.toml        # Cloudflare Workers é…ç½®
â”œâ”€â”€ package.json
â””â”€â”€ tsconfig.json
```

**æ¶æ„è¯´æ˜ï¼š**

- `worker.ts`ï¼šç˜¦è·¯ç”±å±‚ï¼ˆ67 è¡Œï¼‰ï¼Œåªè´Ÿè´£è·¯å¾„åˆ†å‘å’Œ Worker ç”Ÿå‘½å‘¨æœŸç®¡ç†
- `src/core/*`ï¼šçº¯ä¸šåŠ¡é€»è¾‘ï¼Œä¸å…³å¿ƒ HTTP å±‚
- `src/api/*`ï¼šAPI Handlerï¼Œè´Ÿè´£å‚æ•°è§£æå’Œå“åº”æ ¼å¼åŒ–
- `src/frontend/*`ï¼šå‰ç«¯ HTML ç”Ÿæˆï¼ˆåŒ…å«å†…è” JavaScriptï¼‰
- `src/scheduler.ts`ï¼šå®šæ—¶ä»»åŠ¡è°ƒåº¦å™¨ï¼ˆRSS æŠ“å–å’Œæ–‡ç« åˆ†æï¼‰
- `src/config/*`ï¼šé›†ä¸­é…ç½®ç®¡ç†ï¼Œé¿å…ç¡¬ç¼–ç 

è¯¦ç»†æ¶æ„è®¾è®¡è§ [`docs/zimmerwald_v1_1_design.md`](./docs/zimmerwald_v1_1_design.md)

## ğŸ¤ è´¡çŒ®

æ¬¢è¿è´¡çŒ®ï¼è¯·æŸ¥çœ‹ [CONTRIBUTING.md](CONTRIBUTING.md) äº†è§£å¦‚ä½•å‚ä¸é¡¹ç›®ã€‚

## ğŸ“„ è®¸å¯è¯

MIT License

## ğŸ™ è‡´è°¢

æ„Ÿè°¢æ‰€æœ‰ä¸ºå›½é™…å…±äº§ä¸»ä¹‰è¿åŠ¨æä¾›æ–°é—»çš„å·¦ç¿¼åª’ä½“å’Œç»„ç»‡ã€‚

## ğŸ”— ç›¸å…³é“¾æ¥

- [Cloudflare Workers æ–‡æ¡£](https://developers.cloudflare.com/workers/)
- [DeepSeek API](https://platform.deepseek.com/)
- [OpenRouter](https://openrouter.ai/)

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [v1.1 æ¶æ„è®¾è®¡æ–‡æ¡£](./docs/zimmerwald_v1_1_design.md) - å®Œæ•´çš„æ•°æ®åº“ã€APIã€å‰ç«¯è®¾è®¡è§„èŒƒ
- [è´¡çŒ®æŒ‡å—](./CONTRIBUTING.md) - å¦‚ä½•å‚ä¸é¡¹ç›®å¼€å‘

---

**Zimmerwald v1.1 "International"** - ä»¥ 1915 å¹´é½é»˜å°”ç“¦å°”å¾·ä¼šè®®å‘½åï¼Œçºªå¿µå›½é™…å…±äº§ä¸»ä¹‰è¿åŠ¨çš„å›¢ç»“ä¼ ç»Ÿã€‚

